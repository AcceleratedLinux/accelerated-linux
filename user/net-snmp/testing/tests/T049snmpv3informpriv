#!/bin/sh

. ../eval_tools.sh

DEFSECURITYLEVEL=authPriv

HEADER "SNMPv3 informs ($DEFSECURITYLEVEL) received and sent by tools"

SKIPIFNOT NETSNMP_USE_OPENSSL
SKIPIFNOT NETSNMP_ENABLE_SCAPI_AUTHPRIV

#
# Begin test
#

. ./Sv3usmconfigtrapd
CONFIGTRAPD authuser log $TESTPRIVUSER $DEFSECURITYLEVEL
CONFIGTRAPD agentxsocket /dev/null

STARTTRAPD

CAPTURE "snmptrap -Ci -t $SNMP_SLEEP -d $TESTPRIVARGS $SNMP_TRANSPORT_SPEC:$SNMP_TEST_DEST$SNMP_SNMPTRAPD_PORT 0 .1.3.6.1.6.3.1.1.5.1 system.sysContact.0 s received_inform_$DEFSECURITYLEVEL"

STOPTRAPD

CHECKTRAPD "received_inform_$DEFSECURITYLEVEL"

FINISHED
