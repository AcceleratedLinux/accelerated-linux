#!/bin/sh

. ../eval_tools.sh

HEADER SNMPv3 get using SHA/AES of .1.3.6.1.2.1.1.3.0

SKIPIFNOT NETSNMP_USE_OPENSSL
SKIPIFNOT NETSNMP_ENABLE_SCAPI_AUTHPRIV
SKIPIFNOT HAVE_AES_CFB128_ENCRYPT

#
# Begin test
#

# standard V3 configuration for templateSHA user
DEFPRIVTYPE="AES"
DEFAUTHTYPE="SHA"
. ./Sv3config

STARTAGENT

CAPTURE "snmpget -On $SNMP_FLAGS $PRIVTESTARGS $SNMP_TRANSPORT_SPEC:$SNMP_TEST_DEST$SNMP_SNMPD_PORT .1.3.6.1.2.1.1.3.0"

STOPAGENT

CHECK ".1.3.6.1.2.1.1.3.0 = Timeticks:"

FINISHED
