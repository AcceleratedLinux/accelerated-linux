
# Makefile.in for PCRE (Perl-Compatible Regular Expression) library.


# Edited substantially by fyodor@insecure.org to remove libtool dependency
# and strip it to just building the library.

#############################################################################

# PCRE is developed on a Unix system. I do not use Windows or Macs, and know
# nothing about building software on them. Although the code of PCRE should
# be very portable, the building system in this Makefile is designed for Unix
# systems. However, there are features that have been supplied to me by various
# people that should make it work on MinGW and Cygwin systems.

# This setting enables Unix-style directory scanning in pcregrep, triggered
# by the -f option. Maybe one day someone will add code for other systems.

PCREGREP_OSTYPE=-DIS_UNIX

#############################################################################


# Libtool places .o files in the .libs directory; this can mean that "make"
# thinks is it not up-to-date when in fact it is. This setting helps when
# GNU "make" is being used. It presumably does no harm in other cases.

VPATH=.libs


#---------------------------------------------------------------------------#
# The following lines are modified by "configure" to insert data that it is #
# given in its arguments, or which it finds out for itself.                 #
#---------------------------------------------------------------------------#

SHELL = @SHELL@
prefix = @prefix@
exec_prefix = @exec_prefix@
top_srcdir = @top_srcdir@

mkinstalldirs = $(SHELL) $(top_srcdir)/mkinstalldirs

# NB: top_builddir is not referred to directly below, but it is used in the
# setting of $(LIBTOOL), so don't remove it!

top_builddir = .

# BINDIR is the directory in which the pcregrep, pcretest, and pcre-config
#          commands are installed.
# INCDIR is the directory in which the public header files pcre.h and
#          pcreposix.h are installed.
# LIBDIR is the directory in which the libraries are installed.
# MANDIR is the directory in which the man pages are installed.

BINDIR = @bindir@
LIBDIR = @libdir@
INCDIR = @includedir@
MANDIR = @mandir@

# EXEEXT is set by configure to the extention of an executable file
# OBJEXT is set by configure to the extention of an object file
# The BUILD_* equivalents are the same but for the host we're building on

EXEEXT = @EXEEXT@
OBJEXT = @OBJEXT@
# Note that these are just here to have a convenient place to look at the
# outcome.
BUILD_EXEEXT = @BUILD_EXEEXT@
BUILD_OBJEXT = @BUILD_OBJEXT@

# POSIX_OBJ and POSIX_LOBJ are either set empty, or to the names of the
# POSIX object files.

POSIX_OBJ = @POSIX_OBJ@
POSIX_LOBJ = @POSIX_LOBJ@

# The compiler, C flags, preprocessor flags, etc

CC = @CC@
AR = ar
RANLIB = @RANLIB@
CXX = @CXX@
CFLAGS = @CFLAGS@
CXXFLAGS = @CXXFLAGS@
LDFLAGS = @LDFLAGS@
CXXLDFLAGS = @CXXLDFLAGS@

CC_FOR_BUILD = @CC_FOR_BUILD@
CFLAGS_FOR_BUILD = @CFLAGS_FOR_BUILD@
CXX_FOR_BUILD = @CXX_FOR_BUILD@
CXXFLAGS_FOR_BUILD = @CXXFLAGS_FOR_BUILD@
LDFLAGS_FOR_BUILD = $(LDFLAGS)

UCP = @UCP@
NEWLINE = @NEWLINE@
POSIX_MALLOC_THRESHOLD = @POSIX_MALLOC_THRESHOLD@
LINK_SIZE = @LINK_SIZE@
MATCH_LIMIT = @MATCH_LIMIT@ @MATCH_LIMIT_RECURSION@
NO_RECURSE = @NO_RECURSE@
EBCDIC = @EBCDIC@

INCLS = -I. -I$(top_srcdir)
DEFS = $(NEWLINE) $(LINK_SIZE) $(MATCH_LIMIT)
TARGET=libpcre.a
INSTALL = @INSTALL@
INSTALL_DATA = @INSTALL_DATA@

# These are the version numbers for the shared libraries

PCRELIBVERSION = @PCRE_LIB_VERSION@
PCREPOSIXLIBVERSION = @PCRE_POSIXLIB_VERSION@

##############################################################################


OBJ = pcre_chartables.@OBJEXT@ \
  pcre_compile.@OBJEXT@ \
  pcre_config.@OBJEXT@ \
  pcre_dfa_exec.@OBJEXT@ \
  pcre_exec.@OBJEXT@ \
  pcre_fullinfo.@OBJEXT@ \
  pcre_get.@OBJEXT@ \
  pcre_globals.@OBJEXT@ \
  pcre_info.@OBJEXT@ \
  pcre_maketables.@OBJEXT@ \
  pcre_refcount.@OBJEXT@ \
  pcre_study.@OBJEXT@ \
  pcre_tables.@OBJEXT@ \
  pcre_try_flipped.@OBJEXT@ \
  pcre_version.@OBJEXT@ \
  pcre_xclass.@OBJEXT@ \
  $(POSIX_OBJ)

all:            $(TARGET)

# Note that files generated by ./configure and by dftables are in the current
# directory, not the source directory.

pcre_chartables.@OBJEXT@: pcre_chartables.c
		 $(CC) -c $(CFLAGS) $(INCLS) $(DEFS) \
                 $(POSIX_MALLOC_THRESHOLD) pcre_chartables.c

pcre_compile.@OBJEXT@: Makefile config.h $(top_srcdir)/pcre.h \
		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_compile.c
		$(CC) -c $(CFLAGS) $(INCLS) $(DEFS) $(POSIX_MALLOC_THRESHOLD) \
		$(top_srcdir)/pcre_compile.c

pcre_config.@OBJEXT@:  Makefile config.h $(top_srcdir)/pcre.h \
		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_config.c
		$(CC) -c $(CFLAGS) $(INCLS) $(DEFS) $(POSIX_MALLOC_THRESHOLD) \
		$(top_srcdir)/pcre_config.c

pcre_dfa_exec.@OBJEXT@: Makefile config.h $(top_srcdir)/pcre.h \
		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_dfa_exec.c
		$(CC) -c $(CFLAGS) $(INCLS) $(DEFS) $(POSIX_MALLOC_THRESHOLD) \
		$(top_srcdir)/pcre_dfa_exec.c

pcre_exec.@OBJEXT@:    Makefile config.h $(top_srcdir)/pcre.h \
		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_exec.c
		$(CC) -c $(CFLAGS) $(INCLS) $(DEFS) $(POSIX_MALLOC_THRESHOLD) \
		$(top_srcdir)/pcre_exec.c

pcre_fullinfo.@OBJEXT@: Makefile config.h $(top_srcdir)/pcre.h \
		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_fullinfo.c
		$(CC) -c $(CFLAGS) $(INCLS) $(DEFS) $(POSIX_MALLOC_THRESHOLD) \
		$(top_srcdir)/pcre_fullinfo.c

pcre_get.@OBJEXT@:     Makefile config.h $(top_srcdir)/pcre.h \
		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_get.c
		$(CC) -c $(CFLAGS) $(INCLS) $(DEFS) $(POSIX_MALLOC_THRESHOLD) \
		$(top_srcdir)/pcre_get.c

pcre_globals.@OBJEXT@: Makefile config.h $(top_srcdir)/pcre.h \
		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_globals.c
		$(CC) -c $(CFLAGS) $(INCLS) $(DEFS) $(POSIX_MALLOC_THRESHOLD) \
		$(top_srcdir)/pcre_globals.c

pcre_info.@OBJEXT@:    Makefile config.h $(top_srcdir)/pcre.h \
		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_info.c
		$(CC) -c $(CFLAGS) $(INCLS) $(DEFS) $(POSIX_MALLOC_THRESHOLD) \
		$(top_srcdir)/pcre_info.c

pcre_maketables.@OBJEXT@: Makefile config.h $(top_srcdir)/pcre.h \
		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_maketables.c
		$(CC) -c $(CFLAGS) $(INCLS) $(DEFS) $(POSIX_MALLOC_THRESHOLD) \
		$(top_srcdir)/pcre_maketables.c

pcre_refcount.@OBJEXT@:   Makefile config.h $(top_srcdir)/pcre.h \
		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_refcount.c
		$(CC) -c $(CFLAGS) $(INCLS) $(DEFS) $(POSIX_MALLOC_THRESHOLD) \
		$(top_srcdir)/pcre_refcount.c

pcre_study.@OBJEXT@:   Makefile config.h $(top_srcdir)/pcre.h \
		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_study.c
		$(CC) -c $(CFLAGS) $(INCLS) $(DEFS) $(POSIX_MALLOC_THRESHOLD) \
		$(top_srcdir)/pcre_study.c

pcre_tables.@OBJEXT@:  Makefile config.h $(top_srcdir)/pcre.h \
		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_tables.c
		$(CC) -c $(CFLAGS) $(INCLS) $(DEFS) $(POSIX_MALLOC_THRESHOLD) \
		$(top_srcdir)/pcre_tables.c

pcre_try_flipped.@OBJEXT@: Makefile config.h $(top_srcdir)/pcre.h \
		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_try_flipped.c
		$(CC) -c $(CFLAGS) $(INCLS) $(DEFS) $(POSIX_MALLOC_THRESHOLD) \
		$(top_srcdir)/pcre_try_flipped.c

pcre_version.@OBJEXT@: Makefile config.h $(top_srcdir)/pcre.h \
		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_version.c
		$(CC) -c $(CFLAGS) $(INCLS) $(DEFS) $(POSIX_MALLOC_THRESHOLD) \
		$(top_srcdir)/pcre_version.c

pcre_xclass.@OBJEXT@:  Makefile config.h $(top_srcdir)/pcre.h \
		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_xclass.c
		$(CC) -c $(CFLAGS) $(INCLS) $(DEFS) $(POSIX_MALLOC_THRESHOLD) \
		$(top_srcdir)/pcre_xclass.c

pcreposix.@OBJEXT@:    $(top_srcdir)/pcreposix.c $(top_srcdir)/pcreposix.h \
		  $(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre.h config.h Makefile
		@$(LTCOMPILE) $(POSIX_MALLOC_THRESHOLD) $(top_srcdir)/pcreposix.c

$(TARGET):     $(OBJ)
		-rm -f libpcre.a
		$(AR) cr $@ $(OBJ)
		$(RANLIB) $@

# An auxiliary program makes the default character table source. This is put
# in the current directory, NOT the $top_srcdir directory.

pcre_chartables.c:   dftables@BUILD_EXEEXT@
		./dftables@BUILD_EXEEXT@ pcre_chartables.c

dftables.@BUILD_OBJEXT@:     $(top_srcdir)/dftables.c \
		$(top_srcdir)/pcre_maketables.c $(top_srcdir)/pcre_internal.h \
		$(top_srcdir)/pcre.h config.h Makefile
		$(CC) -c $(CFLAGS) $(INCLS) $(DEFS) -I. $(top_srcdir)/dftables.c

dftables@BUILD_EXEEXT@:      dftables.@BUILD_OBJEXT@
	$(CC) $(CFLAGS) -o dftables dftables.@OBJEXT@

# We deliberately omit dftables and pcre_chartables.c from 'make clean'; once
# made pcre_chartables.c shouldn't change, and if people have edited the tables
# by hand, you don't want to throw them away.

clean:;         -rm -rf *.@OBJEXT@ *.lo *.a *.la .libs pcretest@EXEEXT@ pcre_stringpiece_unittest@EXEEXT@ pcrecpp_unittest@EXEEXT@ pcre_scanner_unittest@EXEEXT@ pcregrep@EXEEXT@ testtry

# But "make distclean" should get back to a virgin distribution

distclean:      clean
		-rm -f pcre_chartables.c libtool pcre-config libpcre.pc \
		pcre_stringpiece.h pcrecpparg.h \
		dftables@EXEEXT@ RunGrepTest RunTest \
		Makefile config.h config.status config.log config.cache

# End
