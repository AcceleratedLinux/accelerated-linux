.\"Generated by db2man.xsl. Don't modify this, modify the source.
.de Sh \" Subsection
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Ip \" List item
.br
.ie \\n(.$>=3 .ne \\$3
.el .ne 3
.IP "\\$1" \\$2
..
.TH "VFS_FULL_AUDIT" 8 "" "" ""
.SH "NAME"
vfs_full_audit - record Samba VFS operations in the system log
.SH "SYNOPSIS"
.HP 25
\fBvfs objects = full_audit\fR
.SH "DESCRIPTION"
.PP
This VFS module is part of the
\fBsamba\fR(7)
suite.
.PP
The
\fBvfs_full_audit\fR
VFS module records selected client operations to the system log using
\fBsyslog\fR(3).
.PP
\fBvfs_full_audit\fR
is able to record the complete set of Samba VFS operations:
.IP "" 3n
aio_cancel
.IP "" 3n
aio_error
.IP "" 3n
aio_fsync
.IP "" 3n
aio_read
.IP "" 3n
aio_return
.IP "" 3n
aio_suspend
.IP "" 3n
aio_write
.IP "" 3n
chdir
.IP "" 3n
chflags
.IP "" 3n
chmod
.IP "" 3n
chmod_acl
.IP "" 3n
chown
.IP "" 3n
close
.IP "" 3n
closedir
.IP "" 3n
connect
.IP "" 3n
disconnect
.IP "" 3n
disk_free
.IP "" 3n
fchmod
.IP "" 3n
fchmod_acl
.IP "" 3n
fchown
.IP "" 3n
fget_nt_acl
.IP "" 3n
fgetxattr
.IP "" 3n
flistxattr
.IP "" 3n
fremovexattr
.IP "" 3n
fset_nt_acl
.IP "" 3n
fsetxattr
.IP "" 3n
fstat
.IP "" 3n
fsync
.IP "" 3n
ftruncate
.IP "" 3n
get_nt_acl
.IP "" 3n
get_quota
.IP "" 3n
get_shadow_copy_data
.IP "" 3n
getlock
.IP "" 3n
getwd
.IP "" 3n
getxattr
.IP "" 3n
kernel_flock
.IP "" 3n
lgetxattr
.IP "" 3n
link
.IP "" 3n
linux_setlease
.IP "" 3n
listxattr
.IP "" 3n
llistxattr
.IP "" 3n
lock
.IP "" 3n
lremovexattr
.IP "" 3n
lseek
.IP "" 3n
lsetxattr
.IP "" 3n
lstat
.IP "" 3n
mkdir
.IP "" 3n
mknod
.IP "" 3n
open
.IP "" 3n
opendir
.IP "" 3n
pread
.IP "" 3n
pwrite
.IP "" 3n
read
.IP "" 3n
readdir
.IP "" 3n
readlink
.IP "" 3n
realpath
.IP "" 3n
removexattr
.IP "" 3n
rename
.IP "" 3n
rewinddir
.IP "" 3n
rmdir
.IP "" 3n
seekdir
.IP "" 3n
sendfile
.IP "" 3n
set_nt_acl
.IP "" 3n
set_quota
.IP "" 3n
setxattr
.IP "" 3n
stat
.IP "" 3n
statvfs
.IP "" 3n
symlink
.IP "" 3n
sys_acl_add_perm
.IP "" 3n
sys_acl_clear_perms
.IP "" 3n
sys_acl_create_entry
.IP "" 3n
sys_acl_delete_def_file
.IP "" 3n
sys_acl_free_acl
.IP "" 3n
sys_acl_free_qualifier
.IP "" 3n
sys_acl_free_text
.IP "" 3n
sys_acl_get_entry
.IP "" 3n
sys_acl_get_fd
.IP "" 3n
sys_acl_get_file
.IP "" 3n
sys_acl_get_perm
.IP "" 3n
sys_acl_get_permset
.IP "" 3n
sys_acl_get_qualifier
.IP "" 3n
sys_acl_get_tag_type
.IP "" 3n
sys_acl_init
.IP "" 3n
sys_acl_set_fd
.IP "" 3n
sys_acl_set_file
.IP "" 3n
sys_acl_set_permset
.IP "" 3n
sys_acl_set_qualifier
.IP "" 3n
sys_acl_set_tag_type
.IP "" 3n
sys_acl_to_text
.IP "" 3n
sys_acl_valid
.IP "" 3n
telldir
.IP "" 3n
unlink
.IP "" 3n
utime
.IP "" 3n
write
.PP
In addition to these operations,
\fBvfs_full_audit\fR
recognizes the special operation names "all" and "none ", which refer to all the VFS operations and none of the VFS operations respectively.
.PP
\fBvfs_full_audit\fR
records operations in fixed format consisting of fields separated by '|' characters. The format is:

.nf

		smbd_audit: PREFIX|OPERATION|RESULT|FILE
	
.fi
.PP
The record fields are:
.TP 3n
&#8226;
\fBPREFIX\fR
- the result of the full_audit:prefix string after variable substitutions
.TP 3n
&#8226;
\fBOPERATION\fR
- the name of the VFS operation
.TP 3n
&#8226;
\fBRESULT\fR
- whether the operation succeeded or failed
.TP 3n
&#8226;
\fBFILE\fR
- the name of the file or directory the operation was performed on
.PP
This module is stackable.
.SH "OPTIONS"
.PP
vfs_full_audit:prefix = STRING
.RS 3n
Prepend audit messages with STRING. STRING is processed for standard substitution variables listed in
\fBsmb.conf\fR(5). The default prefix is "%u|%I".
.RE
.PP
vfs_full_audit:success = LIST
.RS 3n
LIST is a list of VFS operations that should be recorded if they succeed. Operations are specified using the names listed above.
.RE
.PP
vfs_full_audit:failure = LIST
.RS 3n
LIST is a list of VFS operations that should be recorded if they failed. Operations are specified using the names listed above.
.RE
.PP
full_audit:facility = FACILITY
.RS 3n
Log messages to the named
\fBsyslog\fR(3)
facility.
.RE
.PP
full_audit:priority = PRIORITY
.RS 3n
Log messages with the named
\fBsyslog\fR(3)
priority.
.RE
.SH "EXAMPLES"
.PP
Log file and directory open operations on the [records] share using the LOCAL7 facility and ALERT priority, including the username and IP address:

.nf

        \fI[records]\fR
	path = /data/records
	vfs objects = full_audit
	full_audit:prefix = %u|%I
	full_audit:success = open opendir
	full_audit:failure = all
	full_audit:facility = LOCAL7
	full_audit:priority = ALERT

.fi
.SH "VERSION"
.PP
This man page is correct for version 3.0.25 of the Samba suite.
.SH "AUTHOR"
.PP
The original Samba software and related utilities were created by Andrew Tridgell. Samba is now developed by the Samba Team as an Open Source project similar to the way the Linux kernel is developed.

