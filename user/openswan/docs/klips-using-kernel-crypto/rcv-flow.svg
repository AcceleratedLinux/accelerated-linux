<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Created with Inkscape (http://www.inkscape.org/) -->
<svg
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   version="1.0"
   width="1224pt"
   height="1584pt"
   id="svg2">
  <defs
     id="defs4">
    <linearGradient
       id="linearGradient5965">
      <stop
         style="stop-color:#000000;stop-opacity:1"
         offset="0"
         id="stop5967" />
      <stop
         style="stop-color:#000000;stop-opacity:0"
         offset="1"
         id="stop5969" />
    </linearGradient>
    <linearGradient
       x1="116.4641"
       y1="-35.127159"
       x2="122.9059"
       y2="12.99684"
       id="linearGradient5971"
       xlink:href="#linearGradient5965"
       gradientUnits="userSpaceOnUse" />
    <linearGradient
       x1="116.4641"
       y1="-35.127159"
       x2="85.770844"
       y2="-8.2231922"
       id="linearGradient5989"
       xlink:href="#linearGradient5965"
       gradientUnits="userSpaceOnUse" />
  </defs>
  <g
     style="display:inline"
     id="layer1">
    <g
       transform="translate(11.75,7.467917)"
       id="g6148">
      <rect
         width="210"
         height="540"
         x="40"
         y="42.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect5902" />
      <text
         x="124.48242"
         y="55.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text5918"
         xml:space="preserve"><tspan
           x="124.48242"
           y="55.505737"
           id="tspan5920">ipssec_rcv()</tspan></text>
    </g>
    <text
       x="109.77068"
       y="29.179203"
       style="font-size:12px;font-style:normal;font-weight:normal;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
       id="text6139"
       xml:space="preserve"><tspan
         x="109.77068"
         y="29.179203"
         id="tspan6141"></tspan></text>
    <text
       x="186.81207"
       y="99.355392"
       style="font-size:12px;font-style:normal;font-weight:normal;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
       id="text5937"
       xml:space="preserve"><tspan
         x="186.81207"
         y="99.355392"
         id="tspan5939"></tspan></text>
    <g
       transform="translate(31.75,28.09292)"
       style="display:inline"
       id="g5949">
      <rect
         width="190"
         height="20"
         x="30"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect5951" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text5953"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           id="tspan5955">ipssec_rcv_state_new()</tspan></text>
    </g>
    <g
       transform="translate(31.75,58.09292)"
       style="display:inline"
       id="g5991">
      <rect
         width="190"
         height="20"
         x="30"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect5993" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text5995"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           id="tspan5997">ipsec_rcv_natt_decap()</tspan></text>
    </g>
    <g
       transform="translate(31.75,88.09292)"
       style="display:inline"
       id="g6003">
      <rect
         width="190"
         height="20"
         x="30"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6005" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6007"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan6009">store hard_header</tspan></text>
    </g>
    <g
       transform="translate(31.75,118.0929)"
       style="display:inline"
       id="g6011">
      <rect
         width="190"
         height="20"
         x="30"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6013" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6015"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           id="tspan6017">ipsec_rcv_unclone()</tspan></text>
    </g>
    <g
       transform="translate(31.75,148.0929)"
       style="display:inline"
       id="g6019">
      <rect
         width="190"
         height="20"
         x="30"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6021" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6023"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           id="tspan6025">skb_linearize()</tspan></text>
    </g>
    <g
       transform="translate(31.75,178.0929)"
       style="display:inline"
       id="g6027">
      <rect
         width="190"
         height="50"
         x="30"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6029" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6031"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan6033">if(natt)</tspan></text>
    </g>
    <g
       transform="translate(31.75,238.0929)"
       style="display:inline"
       id="g6035">
      <rect
         width="190"
         height="20"
         x="30"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6037" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6039"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan6041">decode header</tspan></text>
    </g>
    <g
       transform="translate(31.75,268.0929)"
       style="display:inline"
       id="g6043">
      <rect
         width="190"
         height="20"
         x="30"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6045" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6047"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan6049">find ipsecX device</tspan></text>
    </g>
    <g
       transform="translate(31.75,298.0929)"
       style="display:inline"
       id="g6051">
      <rect
         width="190"
         height="20"
         x="30"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6053" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6055"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan6057">prepare for decap loop</tspan></text>
    </g>
    <g
       transform="translate(19.875,328.0929)"
       style="display:inline"
       id="g6059">
      <rect
         width="190"
         height="110"
         x="40"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6061" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6063"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           id="tspan6065">__ipsec_tunnel_finish()</tspan></text>
    </g>
    <g
       transform="translate(31.75,477.0128)"
       style="display:inline"
       id="g6153">
      <rect
         width="190"
         height="20"
         x="30"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6155" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6157"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           id="tspan6159">ipsec_kfree_skb()</tspan></text>
    </g>
    <g
       transform="translate(31.75,507.0128)"
       style="display:inline"
       id="g6161">
      <rect
         width="190"
         height="20"
         x="30"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6163" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6165"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           id="tspan6167">ipsec_rcv_state_delete()</tspan></text>
    </g>
    <text
       x="60.5"
       y="519.83008"
       style="font-size:12px;font-style:normal;font-weight:normal;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
       id="text6169"
       xml:space="preserve"><tspan
         x="60.5"
         y="519.83008"
         style="font-style:italic"
         id="tspan6171">on error:</tspan></text>
    <g
       transform="translate(310.5,-1.907083)"
       style="display:inline"
       id="g6173">
      <rect
         width="270"
         height="700"
         x="-10"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6175" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6177"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           id="tspan6179">ipsec_rcv_decap()</tspan></text>
    </g>
    <g
       transform="translate(29.875,348.0929)"
       style="display:inline"
       id="g6197">
      <rect
         width="170"
         height="20"
         x="40"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6199" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6201"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-weight:bold"
           id="tspan6203">ipsec_rcv_decap()</tspan></text>
    </g>
    <g
       transform="translate(31.75,198.0929)"
       style="display:inline"
       id="g6237">
      <rect
         width="170"
         height="20"
         x="40"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6239" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6241"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan6243">prepare for ESP</tspan></text>
    </g>
    <g
       transform="translate(29.875,398.0929)"
       style="display:inline"
       id="g6245">
      <rect
         width="150"
         height="20"
         x="50"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6247" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6249"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           id="tspan6251">ipsec_rcv_state_delete()</tspan></text>
    </g>
    <g
       transform="translate(29.875,378.0929)"
       style="display:inline"
       id="g6257">
      <rect
         width="170"
         height="50"
         x="40"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6259" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6261"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan6263">if(natt)</tspan></text>
    </g>
    <path
       d="M 240,410 C 280,410 280,410 280,390 C 280,355.58602 280,124.35675 280,80 C 280,60 280,60 300,60"
       style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;display:inline"
       id="path6265" />
    <g
       transform="translate(310.5,28.09292)"
       style="display:inline"
       id="g6181">
      <rect
         width="250"
         height="80"
         x="0"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6183" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6185"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           id="tspan6187">while (ESP or AH)</tspan></text>
    </g>
    <g
       transform="translate(310.5,48.09292)"
       style="display:inline"
       id="g6189">
      <rect
         width="230"
         height="20"
         x="10"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6191" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6193"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan6195">set proto_funcs</tspan></text>
    </g>
    <g
       transform="translate(310.5,118.0929)"
       style="display:inline"
       id="g6205">
      <rect
         width="250"
         height="50"
         x="0"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6207" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6209"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan6211">if next is IPComp</tspan></text>
    </g>
    <g
       transform="translate(310.5,78.09292)"
       style="display:inline"
       id="g6213">
      <rect
         width="230"
         height="20"
         x="10"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6215" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6217"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-weight:bold"
           id="tspan6219">ipsec_rcv_decap_once()</tspan></text>
    </g>
    <g
       transform="translate(310.5,138.0929)"
       style="display:inline"
       id="g6221">
      <rect
         width="230"
         height="20"
         x="10"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6223" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6225"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan6227">prepare header</tspan></text>
    </g>
    <g
       transform="translate(310.5,198.0929)"
       style="display:inline"
       id="g6229">
      <rect
         width="230"
         height="20"
         x="10"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6231" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6233"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan6235">correct checksum, etc.</tspan></text>
    </g>
    <text
       x="435.6759"
       y="112.95274"
       style="font-size:12px;font-style:normal;font-weight:normal;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
       id="text6293"
       xml:space="preserve"><tspan
         x="435.6759"
         y="112.95274"
         id="tspan6295"></tspan></text>
    <g
       transform="translate(310.5,176.8429)"
       style="display:inline"
       id="g6297">
      <rect
         width="250"
         height="50"
         x="0"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6299" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6301"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan6303">if natt</tspan></text>
    </g>
    <g
       transform="translate(310.5,236.8429)"
       style="display:inline"
       id="g6305">
      <rect
         width="250"
         height="50"
         x="0"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6307" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6309"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan6311">if next header</tspan></text>
    </g>
    <g
       transform="translate(310.5,318.0929)"
       style="display:inline"
       id="g6313">
      <rect
         width="230"
         height="20"
         x="10"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6315" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6317"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan6319">do IPIP decap</tspan></text>
    </g>
    <g
       transform="translate(310.5,258.0929)"
       style="display:inline"
       id="g6321">
      <rect
         width="230"
         height="20"
         x="10"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6323" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6325"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan6327">do policy checks</tspan></text>
    </g>
    <g
       transform="translate(309.875,298.0929)"
       style="display:inline"
       id="g6329">
      <rect
         width="250"
         height="110"
         x="0"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6331" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6333"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan6335">if packet is IPIP</tspan></text>
    </g>
    <g
       transform="translate(309.875,348.0929)"
       style="display:inline"
       id="g6345">
      <rect
         width="230"
         height="20"
         x="10"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6347" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6349"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan6351">do policy checks</tspan></text>
    </g>
    <g
       transform="translate(311.125,378.0929)"
       style="display:inline"
       id="g6357">
      <rect
         width="230"
         height="20"
         x="10"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6359" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6361"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan6363">set nfmark</tspan></text>
    </g>
    <text
       x="441.57068"
       y="441.98721"
       style="font-size:12px;font-style:normal;font-weight:normal;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
       id="text6365"
       xml:space="preserve"><tspan
         x="441.57068"
         y="441.98721"
         id="tspan6367"></tspan></text>
    <g
       transform="translate(311.125,418.0929)"
       style="display:inline"
       id="g6369">
      <rect
         width="250"
         height="20"
         x="0"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6371" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6373"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan6375">restore hard_header</tspan></text>
    </g>
    <g
       transform="translate(310.5,498.0929)"
       style="display:inline"
       id="g6377">
      <rect
         width="230"
         height="20"
         x="10"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6379" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6381"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:normal"
           id="tspan6383">skb_decompress()</tspan></text>
    </g>
    <g
       transform="translate(310.5,448.0929)"
       style="display:inline"
       id="g6385">
      <rect
         width="250"
         height="80"
         x="0"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6387" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6389"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan6391">if packet is IPComp</tspan></text>
    </g>
    <text
       x="468.90088"
       y="504.68594"
       style="font-size:12px;font-style:normal;font-weight:normal;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
       id="text6393"
       xml:space="preserve"><tspan
         x="468.90088"
         y="504.68594"
         id="tspan6395"></tspan></text>
    <g
       transform="translate(309.875,468.0929)"
       style="display:inline"
       id="g6397">
      <rect
         width="230"
         height="20"
         x="10"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6399" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6401"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan6403">do policy checks</tspan></text>
    </g>
    <g
       transform="translate(310.5,536.8429)"
       style="display:inline"
       id="g6405">
      <rect
         width="250"
         height="20"
         x="0"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6407" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6409"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan6411">finalize skb pointers</tspan></text>
    </g>
    <g
       transform="translate(311.125,566.8429)"
       style="display:inline"
       id="g6413">
      <rect
         width="250"
         height="20"
         x="0"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6415" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6417"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan6419">reset conntrack data</tspan></text>
    </g>
    <g
       transform="translate(311.125,598.0929)"
       style="display:inline"
       id="g6421">
      <rect
         width="250"
         height="20"
         x="0"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6423" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6425"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:normal"
           id="tspan6427">netif_rx()</tspan></text>
    </g>
    <g
       transform="translate(310.5,648.0929)"
       style="display:inline"
       id="g6429">
      <rect
         width="250"
         height="20"
         x="0"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6431" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6433"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           id="tspan6435">ipsec_kfree_skb()</tspan></text>
    </g>
    <text
       x="309.25"
       y="690.91016"
       style="font-size:12px;font-style:normal;font-weight:normal;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;display:inline;font-family:Bitstream Vera Sans"
       id="text6437"
       xml:space="preserve"><tspan
         x="309.25"
         y="690.91016"
         style="font-style:italic"
         id="tspan6439">on error:</tspan></text>
    <g
       transform="translate(620.625,-1.737183)"
       style="display:inline"
       id="g6446">
      <rect
         width="270"
         height="727.63782"
         x="-10"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6448" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6450"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           id="tspan6452">ipsec_rcv_decap_once()</tspan></text>
    </g>
    <path
       d="M 550,140 C 590,140 590,140 590,120 C 590,112.1175 590,89.375 590,80 C 590,60 590,60 610,60"
       inkscape:connection-start="#g6213"
       inkscape:connection-end="#g6446"
       style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
       id="path6460" />
    <g
       transform="translate(620.625,27.01282)"
       style="display:inline"
       id="g6464">
      <rect
         width="250"
         height="20"
         x="0"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6466" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6468"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan6470">parse header and setup state vars</tspan></text>
    </g>
    <g
       id="g7474">
      <g
         transform="translate(620.625,58.26282)"
         style="display:inline"
         id="g6476">
        <rect
           width="250"
           height="67.637817"
           x="0"
           y="52.362183"
           style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
           id="rect6478" />
        <text
           x="124.61328"
           y="65.505737"
           style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
           id="text6480"
           xml:space="preserve"><tspan
             x="124.61328"
             y="65.505737"
             style="font-style:normal"
             id="tspan6482">proto_funcs-&gt;rcv_checks()</tspan></text>
      </g>
      <rect
         width="230.625"
         height="39.375"
         x="629.375"
         y="130"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect6486" />
      <text
         x="774.95312"
         y="144.71533"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text6488"
         xml:space="preserve"><tspan
           x="774.95312"
           y="144.71533"
           style="font-style:normal"
           id="tspan6490">ipsec_rcv_ah_checks()</tspan></text>
      <text
         x="774.95312"
         y="162.94678"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;display:inline;font-family:Bitstream Vera Sans"
         id="text6492"
         xml:space="preserve"><tspan
           x="774.95312"
           y="162.94678"
           style="font-style:normal"
           id="tspan6494">ipsec_rcv_esp_checks()</tspan></text>
      <path
         d="M 689.5,130.5 C 689.5,150.5 689.5,170.5 689.5,170.5"
         style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:1, 1;stroke-dashoffset:0;stroke-opacity:1"
         id="path6499" />
      <path
         d="M 860,150 C 830,150 690,150 690,150"
         style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:1, 1;stroke-dashoffset:0;stroke-opacity:1;display:inline"
         id="path7374" />
      <text
         x="660.2168"
         y="145.9458"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;display:inline;font-family:Bitstream Vera Sans"
         id="text7376"
         xml:space="preserve"><tspan
           x="660.2168"
           y="145.9458"
           style="font-style:italic"
           id="tspan7378">case AH:</tspan></text>
      <text
         x="660.375"
         y="164.17725"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;display:inline;font-family:Bitstream Vera Sans"
         id="text7380"
         xml:space="preserve"><tspan
           x="660.375"
           y="164.17725"
           style="font-style:italic"
           id="tspan7382">case ESP:</tspan></text>
      <path
         d="M 690,150 C 660,150 630,150 630,150"
         style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:1, 1;stroke-dashoffset:0;stroke-opacity:1;display:inline"
         id="path7384" />
    </g>
    <g
       transform="translate(620.625,138.2628)"
       style="display:inline"
       id="g7386">
      <rect
         width="250"
         height="20"
         x="0"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect7388" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text7390"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan7392">update state vars</tspan></text>
    </g>
    <g
       transform="translate(619.375,168.2628)"
       style="display:inline"
       id="g7394">
      <rect
         width="250"
         height="20"
         x="0"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect7396" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text7398"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:normal"
           id="tspan7400">ipsec_sa_getbyid()</tspan></text>
    </g>
    <g
       transform="translate(620.625,198.2628)"
       style="display:inline"
       id="g7410">
      <rect
         width="250"
         height="20"
         x="0"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect7412" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text7414"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan7416">SA state, policy and lifetime checks</tspan></text>
    </g>
    <g
       transform="translate(620.625,228.2628)"
       style="display:inline"
       id="g7434">
      <rect
         width="250"
         height="20"
         x="0"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect7436" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text7438"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan7440">update state vars</tspan></text>
    </g>
    <g
       id="g7500">
      <g
         transform="translate(620.625,257.7628)"
         style="display:inline"
         id="g7442">
        <rect
           width="250"
           height="67.637817"
           x="0"
           y="52.362183"
           style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
           id="rect7444" />
        <text
           x="124.61328"
           y="65.505737"
           style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
           id="text7446"
           xml:space="preserve"><tspan
             x="124.61328"
             y="65.505737"
             style="font-style:normal"
             id="tspan7448">proto_funcs-&gt;rcv_setup_auth()</tspan></text>
      </g>
      <rect
         width="230.625"
         height="39.375"
         x="629.375"
         y="329.5"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;display:inline"
         id="rect7450" />
      <text
         x="774.95312"
         y="344.21533"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;display:inline;font-family:Bitstream Vera Sans"
         id="text7452"
         xml:space="preserve"><tspan
           x="774.95312"
           y="344.21533"
           style="font-style:normal"
           id="tspan7454">ipsec_rcv_ah_setup_auth()</tspan></text>
      <text
         x="774.95312"
         y="362.44678"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;display:inline;font-family:Bitstream Vera Sans"
         id="text7456"
         xml:space="preserve"><tspan
           x="774.95312"
           y="362.44678"
           style="font-style:normal"
           id="tspan7458">ipsec_rcv_esp_setup_auth()</tspan></text>
      <path
         d="M 689.5,330 C 689.5,350 689.5,370 689.5,370"
         style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:1, 1;stroke-dashoffset:0;stroke-opacity:1;display:inline"
         id="path7460" />
      <path
         d="M 860,349.5 C 830,349.5 690,349.5 690,349.5"
         style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:1, 1;stroke-dashoffset:0;stroke-opacity:1;display:inline"
         id="path7462" />
      <text
         x="660.2168"
         y="345.4458"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;display:inline;font-family:Bitstream Vera Sans"
         id="text7464"
         xml:space="preserve"><tspan
           x="660.2168"
           y="345.4458"
           style="font-style:italic"
           id="tspan7466">case AH:</tspan></text>
      <text
         x="660.375"
         y="363.67725"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;display:inline;font-family:Bitstream Vera Sans"
         id="text7468"
         xml:space="preserve"><tspan
           x="660.375"
           y="363.67725"
           style="font-style:italic"
           id="tspan7470">case ESP:</tspan></text>
      <path
         d="M 690,349.5 C 660,349.5 630,349.5 630,349.5"
         style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:1, 1;stroke-dashoffset:0;stroke-opacity:1;display:inline"
         id="path7472" />
    </g>
    <g
       transform="translate(620,338.2628)"
       style="display:inline"
       id="g7492">
      <rect
         width="250"
         height="20"
         x="0"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect7494" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text7496"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:normal"
           id="tspan7498">ipsec_checkreplaywindow()</tspan></text>
    </g>
    <g
       transform="translate(0,110.5)"
       style="display:inline"
       id="g7526">
      <g
         transform="translate(620.625,257.7628)"
         style="display:inline"
         id="g7528">
        <rect
           width="250"
           height="67.637817"
           x="0"
           y="52.362183"
           style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
           id="rect7530" />
        <text
           x="124.61328"
           y="65.505737"
           style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
           id="text7532"
           xml:space="preserve"><tspan
             x="124.61328"
             y="65.505737"
             style="font-style:normal"
             id="tspan7534">proto_funcs-&gt;rcv_calc_auth()</tspan></text>
      </g>
      <rect
         width="230.625"
         height="39.375"
         x="629.375"
         y="329.5"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;display:inline"
         id="rect7536" />
      <text
         x="774.95312"
         y="344.21533"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;display:inline;font-family:Bitstream Vera Sans"
         id="text7538"
         xml:space="preserve"><tspan
           x="774.95312"
           y="344.21533"
           style="font-style:normal"
           id="tspan7540">ipsec_rcv_ah_calc_auth()</tspan></text>
      <text
         x="774.95312"
         y="362.44678"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;display:inline;font-family:Bitstream Vera Sans"
         id="text7542"
         xml:space="preserve"><tspan
           x="774.95312"
           y="362.44678"
           style="font-style:normal"
           id="tspan7544">ipsec_rcv_esp_calc_auth()</tspan></text>
      <path
         d="M 689.5,330 C 689.5,350 689.5,370 689.5,370"
         style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:1, 1;stroke-dashoffset:0;stroke-opacity:1;display:inline"
         id="path7546" />
      <path
         d="M 860,349.5 C 830,349.5 690,349.5 690,349.5"
         style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:1, 1;stroke-dashoffset:0;stroke-opacity:1;display:inline"
         id="path7548" />
      <text
         x="660.2168"
         y="345.4458"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;display:inline;font-family:Bitstream Vera Sans"
         id="text7550"
         xml:space="preserve"><tspan
           x="660.2168"
           y="345.4458"
           style="font-style:italic"
           id="tspan7552">case AH:</tspan></text>
      <text
         x="660.375"
         y="363.67725"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;display:inline;font-family:Bitstream Vera Sans"
         id="text7554"
         xml:space="preserve"><tspan
           x="660.375"
           y="363.67725"
           style="font-style:italic"
           id="tspan7556">case ESP:</tspan></text>
      <path
         d="M 690,349.5 C 660,349.5 630,349.5 630,349.5"
         style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:1, 1;stroke-dashoffset:0;stroke-opacity:1;display:inline"
         id="path7558" />
    </g>
    <g
       transform="translate(620.625,447.0128)"
       style="display:inline"
       id="g7560">
      <rect
         width="250"
         height="20"
         x="0"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect7562" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text7564"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan7566">test digest result and replay window</tspan></text>
    </g>
    <g
       transform="translate(620.625,478.2628)"
       style="display:inline"
       id="g7568">
      <rect
         width="250"
         height="20"
         x="0"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect7570" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text7572"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:normal"
           id="tspan7574">ipsec_updatereplaywindow()</tspan></text>
    </g>
    <text
       x="706.5"
       y="539.5"
       style="font-size:12px;font-style:normal;font-weight:normal;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
       id="text7576"
       xml:space="preserve"><tspan
         x="706.5"
         y="539.5"
         id="tspan7578"></tspan></text>
    <g
       id="g7664">
      <g
         transform="translate(620.625,508.2628)"
         style="display:inline"
         id="g7582">
        <rect
           width="250"
           height="87.637817"
           x="0"
           y="52.362183"
           style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
           id="rect7584" />
        <text
           x="124.61328"
           y="65.505737"
           style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
           id="text7586"
           xml:space="preserve"><tspan
             x="124.61328"
             y="65.505737"
             style="font-style:normal"
             id="tspan7588">proto_funcs-&gt;rcv_decrypt()</tspan></text>
      </g>
      <rect
         width="230.625"
         height="60"
         x="629.375"
         y="580"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;display:inline"
         id="rect7590" />
      <text
         x="774.95312"
         y="594.71533"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;display:inline;font-family:Bitstream Vera Sans"
         id="text7592"
         xml:space="preserve"><tspan
           x="774.95312"
           y="594.71533"
           style="font-style:normal"
           id="tspan7594">ipsec_rcv_ah_decap()</tspan></text>
      <text
         x="774.95312"
         y="612.94678"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;display:inline;font-family:Bitstream Vera Sans"
         id="text7596"
         xml:space="preserve"><tspan
           x="774.95312"
           y="612.94678"
           style="font-style:normal"
           id="tspan7598">ipsec_rcv_esp_decrypt()</tspan></text>
      <path
         d="M 689.5,580.5 C 689.5,600.5 690,640 690,640"
         style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:1, 1;stroke-dashoffset:0;stroke-opacity:1;display:inline"
         id="path7600" />
      <path
         d="M 860,600 C 830,600 690,600 690,600"
         style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:1, 1;stroke-dashoffset:0;stroke-opacity:1;display:inline"
         id="path7602" />
      <text
         x="660.2168"
         y="595.9458"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;display:inline;font-family:Bitstream Vera Sans"
         id="text7604"
         xml:space="preserve"><tspan
           x="660.2168"
           y="595.9458"
           style="font-style:italic"
           id="tspan7606">case AH:</tspan></text>
      <text
         x="660.2168"
         y="614.17725"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;display:inline;font-family:Bitstream Vera Sans"
         id="text7608"
         xml:space="preserve"><tspan
           x="660.2168"
           y="614.17725"
           style="font-style:italic"
           id="tspan7610">case ESP:</tspan></text>
      <path
         d="M 690,600 C 660,600 630,600 630,600"
         style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:1, 1;stroke-dashoffset:0;stroke-opacity:1;display:inline"
         id="path7612" />
      <path
         d="M 860,620.5 C 830,620.5 690,620.5 690,620.5"
         style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:1, 1;stroke-dashoffset:0;stroke-opacity:1;display:inline"
         id="path7632" />
      <path
         d="M 690,620.5 C 660,620.5 630,620.5 630,620.5"
         style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:1, 1;stroke-dashoffset:0;stroke-opacity:1;display:inline"
         id="path7634" />
      <text
         x="712.61713"
         y="587.51764"
         transform="scale(0.926425,1.079419)"
         style="font-size:11.11709881px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;display:inline;font-family:Bitstream Vera Sans"
         id="text7636"
         xml:space="preserve"><tspan
           x="712.61713"
           y="587.51764"
           style="font-style:italic"
           id="tspan7638">case COMP:</tspan></text>
      <text
         x="813.74799"
         y="603.77771"
         transform="scale(0.952331,1.050055)"
         style="font-size:11.42796898px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:100%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;display:inline;font-family:Bitstream Vera Sans"
         id="text7640"
         xml:space="preserve"><tspan
           x="813.74799"
           y="603.77771"
           style="font-size:11.42796898px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:100%;writing-mode:lr-tb;text-anchor:middle;font-family:Bitstream Vera Sans"
           id="tspan7642">ipsec_rcv_ipcomp_decomp()</tspan></text>
    </g>
    <g
       transform="translate(620.625,607.0128)"
       style="display:inline"
       id="g7644">
      <rect
         width="250"
         height="20"
         x="0"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect7646" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text7648"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan7650">update state and cleanup</tspan></text>
    </g>
    <g
       transform="translate(619.375,638.2628)"
       style="display:inline"
       id="g7652">
      <rect
         width="250"
         height="20"
         x="0"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect7654" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text7656"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan7658">policy checks</tspan></text>
    </g>
    <text
       x="732.5"
       y="703"
       style="font-size:12px;font-style:normal;font-weight:normal;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
       id="text7660"
       xml:space="preserve"><tspan
         x="732.5"
         y="703"
         id="tspan7662"></tspan></text>
    <text
       x="715.5"
       y="728"
       style="font-size:12px;font-style:normal;font-weight:normal;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
       id="text7688"
       xml:space="preserve"><tspan
         x="715.5"
         y="728"
         id="tspan7690"></tspan></text>
    <g
       transform="translate(619.375,690)"
       style="display:inline"
       id="g7692">
      <rect
         width="230"
         height="17.637817"
         x="10"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect7694" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text7696"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan7698">set nfmark</tspan></text>
    </g>
    <g
       transform="translate(620,668.2628)"
       style="display:inline"
       id="g7700">
      <rect
         width="250"
         height="47.637817"
         x="0"
         y="52.362183"
         style="fill:none;fill-opacity:0.75;stroke:#000000;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         id="rect7702" />
      <text
         x="124.61328"
         y="65.505737"
         style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:125%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
         id="text7704"
         xml:space="preserve"><tspan
           x="124.61328"
           y="65.505737"
           style="font-style:italic"
           id="tspan7706">if packet is ESP or AH</tspan></text>
    </g>
  </g>
</svg>
