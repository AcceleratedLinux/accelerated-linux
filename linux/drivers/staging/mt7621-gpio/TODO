- general code review and clean up

Cc:  NeilBrown <neil@brown.name>
