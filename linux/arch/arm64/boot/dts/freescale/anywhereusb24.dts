// SPDX-License-Identifier: (GPL-2.0+ OR MIT)
/*
 * Device Tree Include file for Digi AnywhereUSB-8.
 *
 * Copyright 2016 Freescale Semiconductor, Inc.
 * Copyright 2018.2019 Digi Inc.
 *
 * Mingkai Hu <mingkai.hu@nxp.com>
 * Greg Ungerer <gregory.ungerer@digi.com>
 */

/dts-v1/;

#include "fsl-ls1046a.dtsi"
#include <dt-bindings/interrupt-controller/arm-gic.h>
#include <dt-bindings/gpio/gpio.h>
#include <dt-bindings/input/input.h>
#include "fsl-pstore-2048MB.dtsi"

/ {
	model = "Digi AnywhereUSB-24";
	compatible = "digi,anywhereusb24", "fsl,ls1046a";

	aliases {
		serial0 = &duart0;
		serial1 = &duart1;
		serial2 = &duart2;
		serial3 = &duart3;
	};

	chosen {
		stdout-path = "serial0:115200n8";
	};

	soc {
		esdhc: esdhc@1560000 {
			compatible = "fsl,ls1046a-esdhc", "fsl,esdhc";
			reg = <0x0 0x1560000 0x0 0x10000>;
			interrupts = <GIC_SPI 62 IRQ_TYPE_LEVEL_HIGH>;
			clocks = <&clockgen 2 1>;
			voltage-ranges = <3300 3300>;
			sdhci,auto-cmd12;
			big-endian;
			bus-width = <4>;
			max-frequency = <12500000>;
		};

		 pcie@3400000 {
			compatible = "fsl,ls1046a-pcie", "snps,dw-pcie";
			status = "okay";
			num-ib-windows = <6>;
			num-ob-windows = <6>;
		 };
		 pcie@3500000 {
			compatible = "fsl,ls1046a-pcie", "snps,dw-pcie";
			status = "okay";
			num-ib-windows = <6>;
			num-ob-windows = <6>;
		 };
		 pcie@3600000 {
			compatible = "fsl,ls1046a-pcie", "snps,dw-pcie";
			status = "okay";
			num-ib-windows = <6>;
			num-ob-windows = <6>;
		 };

		aux_bus {
			usb0: usb@2f00000 {
				usb2-lpm-disable;
				snps,dis_u3_susphy_quirk;
				snps,dis_u2_susphy_quirk;
				snps,dis_enblslpm_quirk;
				snps,dis-u1u2-when-u3-quirk;
				snps,incr-burst-type-adjustment = <1>, <4>, <8>, <16>;
				clock-names = "ref", "bus_early", "suspend";
				clocks = <&clockgen 4 1>, <&clockgen 4 1>,<&clockgen 4 1>;
			};

			usb1: usb@3000000 {
				usb2-lpm-disable;
				snps,dis_u3_susphy_quirk;
				snps,dis_u2_susphy_quirk;
				snps,dis_enblslpm_quirk;
				snps,dis-u1u2-when-u3-quirk;
				snps,incr-burst-type-adjustment = <1>, <4>, <8>, <16>;
				clock-names = "ref", "bus_early", "suspend";
				clocks = <&clockgen 4 1>, <&clockgen 4 1>,<&clockgen 4 1>;
			};

			usb2: usb@3100000 {
				usb2-lpm-disable;
				snps,dis_u3_susphy_quirk;
				snps,dis_u2_susphy_quirk;
				snps,dis_enblslpm_quirk;
				snps,dis-u1u2-when-u3-quirk;
				snps,incr-burst-type-adjustment = <1>, <4>, <8>, <16>;
				clock-names = "ref", "bus_early", "suspend";
				clocks = <&clockgen 4 1>, <&clockgen 4 1>,<&clockgen 4 1>;
			};
		};
	};

	gpio-keys {
		compatible = "gpio-keys";
		factory-button {
			label = "factory";
			linux,code = <KEY_DELETE>;
			gpios = <&gpio0 31 GPIO_ACTIVE_LOW>;
		};
	};

	sfp1: sfp1 {
		compatible = "sff,sfp";
		i2c-bus = <&i2c0>;
		mod-def0-gpios = <&gpio0 24 GPIO_ACTIVE_LOW>;
		maximum-power-milliwatt = <1000>;
	};

	sfp2: sfp2 {
		compatible = "sff,sfp";
		i2c-bus = <&i2c2>;
		mod-def0-gpios = <&gpio0 25 GPIO_ACTIVE_LOW>;
		maximum-power-milliwatt = <1000>;
	};
};

&duart0 {
	status = "okay";
	/*dtr-gpios = <&gpio0 27 GPIO_ACTIVE_LOW>;
	dsr-gpios = <&gpio0 29 GPIO_ACTIVE_LOW>;
	dcd-gpios = <&gpio0 28 GPIO_ACTIVE_LOW>;
	rng-gpios = <&gpio0 30 GPIO_ACTIVE_LOW>;
	uart-has-rtscts;*/
};

&i2c0 {
	status = "okay";
	awusb24_cpld@59 {
		compatible = "digi,awusb24_cpld";
		reg = <0x59>;
		#address-cells = <1>;
		#size-cells = <0>;

		fan1r {
		    name = "fan1r";
		    reg = <0x32>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		fan1g {
		    name = "fan1g";
		    reg = <0x32>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		fan2r {
		    name = "fan2r";
		    reg = <0x33>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		fan2g {
		    name = "fan2g";
		    reg = <0x33>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		wansigr {
		    name = "wansigr";
		    reg = <0x34>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		wansigg {
		    name = "wansigg";
		    reg = <0x34>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		wanserr {
		    name = "wanserr";
		    reg = <0x35>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		wanserg {
		    name = "wanserg";
		    reg = <0x35>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		wifir {
		    name = "wifir";
		    reg = <0x36>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		wifig {
		    name = "wifig";
		    reg = <0x36>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		usrr {
		    name = "usrr";
		    reg = <0x37>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		usrg {
		    name = "usrg";
		    reg = <0x37>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		r01 {
		    name = "r01";
		    reg = <0x38>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		g01 {
		    name = "g01";
		    reg = <0x38>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		b01 {
		    name = "b01";
		    reg = <0x38>;
		    led = /bits/ 8 <0x01>;
		    linux,default-trigger = "timer";
		};
		r02 {
		    name = "r02";
		    reg = <0x39>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		g02 {
		    name = "g02";
		    reg = <0x39>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		b02 {
		    name = "b02";
		    reg = <0x39>;
		    led = /bits/ 8 <0x01>;
		    linux,default-trigger = "timer";
		};
		r03 {
		    name = "r03";
		    reg = <0x3a>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		g03 {
		    name = "g03";
		    reg = <0x3a>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		b03 {
		    name = "b03";
		    reg = <0x3a>;
		    led = /bits/ 8 <0x01>;
		    linux,default-trigger = "timer";
		};
		r04 {
		    name = "r04";
		    reg = <0x3b>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		g04 {
		    name = "g04";
		    reg = <0x3b>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		b04 {
		    name = "b04";
		    reg = <0x3b>;
		    led = /bits/ 8 <0x01>;
		    linux,default-trigger = "timer";
		};
		r05 {
		    name = "r05";
		    reg = <0x3c>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		g05 {
		    name = "g05";
		    reg = <0x3c>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		b05 {
		    name = "b05";
		    reg = <0x3c>;
		    led = /bits/ 8 <0x01>;
		    linux,default-trigger = "timer";
		};
		r06 {
		    name = "r06";
		    reg = <0x3d>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		g06 {
		    name = "g06";
		    reg = <0x3d>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		b06 {
		    name = "b06";
		    reg = <0x3d>;
		    led = /bits/ 8 <0x01>;
		    linux,default-trigger = "timer";
		};
		r07 {
		    name = "r07";
		    reg = <0x3e>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		g07 {
		    name = "g07";
		    reg = <0x3e>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		b07 {
		    name = "b07";
		    reg = <0x3e>;
		    led = /bits/ 8 <0x01>;
		    linux,default-trigger = "timer";
		};
		r08 {
		    name = "r08";
		    reg = <0x3f>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		g08 {
		    name = "g08";
		    reg = <0x3f>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		b08 {
		    name = "b08";
		    reg = <0x3f>;
		    led = /bits/ 8 <0x01>;
		    linux,default-trigger = "timer";
		};
		r09 {
		    name = "r09";
		    reg = <0x40>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		g09 {
		    name = "g09";
		    reg = <0x40>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		b09 {
		    name = "b09";
		    reg = <0x40>;
		    led = /bits/ 8 <0x01>;
		    linux,default-trigger = "timer";
		};
		r10 {
		    name = "r10";
		    reg = <0x41>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		g10 {
		    name = "g10";
		    reg = <0x41>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		b10 {
		    name = "b10";
		    reg = <0x41>;
		    led = /bits/ 8 <0x01>;
		    linux,default-trigger = "timer";
		};
		r11 {
		    name = "r11";
		    reg = <0x42>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		g11 {
		    name = "g11";
		    reg = <0x42>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		b11 {
		    name = "b11";
		    reg = <0x42>;
		    led = /bits/ 8 <0x01>;
		    linux,default-trigger = "timer";
		};
		r12 {
		    name = "r12";
		    reg = <0x43>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		g12 {
		    name = "g12";
		    reg = <0x43>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		b12 {
		    name = "b12";
		    reg = <0x43>;
		    led = /bits/ 8 <0x01>;
		    linux,default-trigger = "timer";
		};
		r13 {
		    name = "r13";
		    reg = <0x44>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		g13 {
		    name = "g13";
		    reg = <0x44>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		b13 {
		    name = "b13";
		    reg = <0x44>;
		    led = /bits/ 8 <0x01>;
		    linux,default-trigger = "timer";
		};
		r14 {
		    name = "r14";
		    reg = <0x45>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		g14 {
		    name = "g14";
		    reg = <0x45>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		b14 {
		    name = "b14";
		    reg = <0x45>;
		    led = /bits/ 8 <0x01>;
		    linux,default-trigger = "timer";
		};
		r15 {
		    name = "r15";
		    reg = <0x46>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		g15 {
		    name = "g15";
		    reg = <0x46>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		b15 {
		    name = "b15";
		    reg = <0x46>;
		    led = /bits/ 8 <0x01>;
		    linux,default-trigger = "timer";
		};
		r16 {
		    name = "r16";
		    reg = <0x47>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		g16 {
		    name = "g16";
		    reg = <0x47>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		b16 {
		    name = "b16";
		    reg = <0x47>;
		    led = /bits/ 8 <0x01>;
		    linux,default-trigger = "timer";
		};
		r17 {
		    name = "r17";
		    reg = <0x48>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		g17 {
		    name = "g17";
		    reg = <0x48>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		b17 {
		    name = "b17";
		    reg = <0x48>;
		    led = /bits/ 8 <0x01>;
		    linux,default-trigger = "timer";
		};
		r18 {
		    name = "r18";
		    reg = <0x49>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		g18 {
		    name = "g18";
		    reg = <0x49>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		b18 {
		    name = "b18";
		    reg = <0x49>;
		    led = /bits/ 8 <0x01>;
		    linux,default-trigger = "timer";
		};
		r19 {
		    name = "r19";
		    reg = <0x4a>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		g19 {
		    name = "g19";
		    reg = <0x4a>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		b19 {
		    name = "b19";
		    reg = <0x4a>;
		    led = /bits/ 8 <0x01>;
		    linux,default-trigger = "timer";
		};
		r20 {
		    name = "r20";
		    reg = <0x4b>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		g20 {
		    name = "g20";
		    reg = <0x4b>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		b20 {
		    name = "b20";
		    reg = <0x4b>;
		    led = /bits/ 8 <0x01>;
		    linux,default-trigger = "timer";
		};
		r21 {
		    name = "r21";
		    reg = <0x4c>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		g21 {
		    name = "g21";
		    reg = <0x4c>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		b21 {
		    name = "b21";
		    reg = <0x4c>;
		    led = /bits/ 8 <0x01>;
		    linux,default-trigger = "timer";
		};
		r22 {
		    name = "r22";
		    reg = <0x4d>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		g22 {
		    name = "g22";
		    reg = <0x4d>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		b22 {
		    name = "b22";
		    reg = <0x4d>;
		    led = /bits/ 8 <0x01>;
		    linux,default-trigger = "timer";
		};
		r23 {
		    name = "r23";
		    reg = <0x4e>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		g23 {
		    name = "g23";
		    reg = <0x4e>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		b23 {
		    name = "b23";
		    reg = <0x4e>;
		    led = /bits/ 8 <0x01>;
		    linux,default-trigger = "timer";
		};
		r24 {
		    name = "r24";
		    reg = <0x4f>;
		    led = /bits/ 8 <0x04>;
		    linux,default-trigger = "timer";
		};
		g24 {
		    name = "g24";
		    reg = <0x4f>;
		    led = /bits/ 8 <0x02>;
		    linux,default-trigger = "timer";
		};
		b24 {
		    name = "b24";
		    reg = <0x4f>;
		    led = /bits/ 8 <0x01>;
		    linux,default-trigger = "timer";
		};
	};

	rtc@68 {
		compatible = "idt,ds1337";
		reg = <0x68>;
	};
};

&i2c2 {
	status = "okay";
};

&i2c3 {
	clock-frequency = <1000000>;
	status = "okay";

	rng: atecc508a@60 {
		compatible = "atsha204-i2c";
		reg = <0x60>;
	};
};

&qspi {
	num-cs = <1>;
	bus-num = <0>;
	status = "okay";

	qflash0: mx25u3235f@0 {
		compatible = "jedec,spi-nor";
		#address-cells = <1>;
		#size-cells = <1>;
		spi-max-frequency = <20000000>;
		spi-rx-bus-width = <1>;
		spi-tx-bus-width = <1>;
		reg = <0>;
	};
};

&soc {
#include "qoriq-fman3-0.dtsi"
#include "qoriq-fman3-0-1g-0.dtsi"
#include "qoriq-fman3-0-1g-1.dtsi"
#include "qoriq-fman3-0-1g-2.dtsi"
#include "qoriq-fman3-0-1g-3.dtsi"
#include "qoriq-fman3-0-1g-4.dtsi"
#include "qoriq-fman3-0-1g-5.dtsi"
#include "qoriq-fman3-0-10g-0.dtsi"
#include "qoriq-fman3-0-10g-1.dtsi"

	fsldpaa: fsl,dpaa {
		compatible = "fsl,ls1043a-dpaa", "simple-bus", "fsl,dpaa";
		ethernet@0 {
			compatible = "fsl,dpa-ethernet";
			fsl,fman-mac = <&enet0>;
			dma-coherent;
		};
		ethernet@1 {
			compatible = "fsl,dpa-ethernet";
			fsl,fman-mac = <&enet1>;
			dma-coherent;
		};
	};
};

&fman0 {
	enet0: ethernet@f0000 {
		phy-handle = <&phy0>;
		phy-connection-type = "xgmii";
	};

	enet1: ethernet@f2000 {
		phy-handle = <&phy1>;
		phy-connection-type = "xgmii";
	};

	enet2: ethernet@e0000 {
		status = "disabled";
	};

	enet3: ethernet@e2000 {
		status = "disabled";
	};

	enet4: ethernet@e4000 {
		status = "disabled";
	};

	enet5: ethernet@e6000 {
		status = "disabled";
	};

	enet6: ethernet@e8000 {
		status = "disabled";
	};

	enet7: ethernet@ea000 {
		status = "disabled";
	};

	mdio@fd000 {
		phy0: ethernet-phy@0 {
			compatible = "ethernet-phy-ieee802.3-c45";
			reg = <28>;
			sfp = <&sfp1>;
		};

		phy1: ethernet-phy@1 {
			compatible = "ethernet-phy-ieee802.3-c45";
			reg = <29>;
			sfp = <&sfp2>;
		};
	};
};

&gpio0 {
	gpio-line-names = "", "", "", "", "", "", "", "",
			  "", "", "", "", "", "", "", "",
			  "", "", "", "", "", "", "", "",
			  "", "", "", "", "", "", "", "factory";
};
