From 7e24d6d92f1cef6740014814a36c3aa3dc199ed7 Mon Sep 17 00:00:00 2001
From: Robert Hodaszi <robert.hodaszi@digi.com>
Date: Fri, 30 Aug 2024 16:19:44 +0200
Subject: [PATCH] Remove user host pwd from version

---
 build/mkversion | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

diff --git a/build/mkversion b/build/mkversion
index 19cbd8084f24..191468c21669 100755
--- a/build/mkversion
+++ b/build/mkversion
@@ -53,8 +53,12 @@ APPLICATION=$1
 # Reproducible builds set SOURCE_DATE_EPOCH, want constant strings
 if [ -n "${SOURCE_DATE_EPOCH}" ]; then
    WHOWHERE="openldap"
+   DATE=$(date -d@$SOURCE_DATE_EPOCH +' %b %d %Y ')
+   TIME=$(date -d@$SOURCE_DATE_EPOCH +' %H:%M:%S ')
 else
-   WHOWHERE="$USER@$(uname -n):$(pwd)"
+   WHOWHERE="openldap"
+   DATE='" __DATE__ "'
+   TIME='" __TIME__ "'
 fi
 
 cat << __EOF__
@@ -77,7 +81,7 @@ static const char copyright[] =
 "COPYING RESTRICTIONS APPLY\n";
 
 $static $const char $SYMBOL[] =
-"@(#) \$$PACKAGE: $APPLICATION $VERSION (" __DATE__ " " __TIME__ ") \$\n"
+"@(#) \$$PACKAGE: $APPLICATION $VERSION ($DATE $TIME) \$\n"
 "\t$WHOWHERE\n";
 
 __EOF__
-- 
2.43.0

